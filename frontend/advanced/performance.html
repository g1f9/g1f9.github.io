<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>性能优化类 | g1f9</title>
    <meta name="description" content="记录">
    
    
    <link rel="preload" href="/assets/css/0.styles.74efe9eb.css" as="style"><link rel="preload" href="/assets/js/app.ccbd119b.js" as="script"><link rel="preload" href="/assets/js/2.7f0dc0b6.js" as="script"><link rel="preload" href="/assets/js/10.0efb1b32.js" as="script"><link rel="prefetch" href="/assets/js/11.c90cd893.js"><link rel="prefetch" href="/assets/js/12.972c5b8f.js"><link rel="prefetch" href="/assets/js/13.2badb955.js"><link rel="prefetch" href="/assets/js/14.b0df3f85.js"><link rel="prefetch" href="/assets/js/15.5d827cb8.js"><link rel="prefetch" href="/assets/js/16.c6f4a891.js"><link rel="prefetch" href="/assets/js/17.27916a81.js"><link rel="prefetch" href="/assets/js/18.11f598b4.js"><link rel="prefetch" href="/assets/js/19.73dae33a.js"><link rel="prefetch" href="/assets/js/20.15c25eec.js"><link rel="prefetch" href="/assets/js/21.a870acbb.js"><link rel="prefetch" href="/assets/js/22.ca308be0.js"><link rel="prefetch" href="/assets/js/23.a3e9e8f8.js"><link rel="prefetch" href="/assets/js/24.b6bb07e2.js"><link rel="prefetch" href="/assets/js/25.0359653c.js"><link rel="prefetch" href="/assets/js/26.a09d11a6.js"><link rel="prefetch" href="/assets/js/27.9a34aab8.js"><link rel="prefetch" href="/assets/js/28.1262566c.js"><link rel="prefetch" href="/assets/js/29.3eb81e77.js"><link rel="prefetch" href="/assets/js/3.d46bcc0e.js"><link rel="prefetch" href="/assets/js/30.faa6dd9c.js"><link rel="prefetch" href="/assets/js/31.3b40da97.js"><link rel="prefetch" href="/assets/js/32.eec2213b.js"><link rel="prefetch" href="/assets/js/33.14287cf7.js"><link rel="prefetch" href="/assets/js/4.570df549.js"><link rel="prefetch" href="/assets/js/5.482ae8ae.js"><link rel="prefetch" href="/assets/js/6.32b63521.js"><link rel="prefetch" href="/assets/js/7.5ad4d5a2.js"><link rel="prefetch" href="/assets/js/8.890852ad.js"><link rel="prefetch" href="/assets/js/9.4be23048.js">
    <link rel="stylesheet" href="/assets/css/0.styles.74efe9eb.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">g1f9</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/resource.html" class="nav-link">资源收集</a></li><li class="dropdown-item"><!----> <a href="/frontend/basics/" class="nav-link">基础阅读</a></li><li class="dropdown-item"><!----> <a href="/frontend/read-code/" class="nav-link">源码阅读</a></li><li class="dropdown-item"><!----> <a href="/frontend/advanced/" class="nav-link router-link-active">扩展阅读</a></li><li class="dropdown-item"><!----> <a href="/frontend/note/" class="nav-link">笔记</a></li><li class="dropdown-item"><!----> <a href="/frontend/source/" class="nav-link">资源收集</a></li></ul></div></div><div class="nav-item"><a href="/tools/" class="nav-link">工具</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/resource.html" class="nav-link">资源收集</a></li><li class="dropdown-item"><!----> <a href="/frontend/basics/" class="nav-link">基础阅读</a></li><li class="dropdown-item"><!----> <a href="/frontend/read-code/" class="nav-link">源码阅读</a></li><li class="dropdown-item"><!----> <a href="/frontend/advanced/" class="nav-link router-link-active">扩展阅读</a></li><li class="dropdown-item"><!----> <a href="/frontend/note/" class="nav-link">笔记</a></li><li class="dropdown-item"><!----> <a href="/frontend/source/" class="nav-link">资源收集</a></li></ul></div></div><div class="nav-item"><a href="/tools/" class="nav-link">工具</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>性能优化类</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/frontend/advanced/performance.html#性能测试" class="sidebar-link">性能测试</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/frontend/advanced/performance.html#性能优化" class="sidebar-link">性能优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/frontend/advanced/performance.html#网络资源加载优化" class="sidebar-link">网络资源加载优化</a></li><li class="sidebar-sub-header"><a href="/frontend/advanced/performance.html#页面渲染类" class="sidebar-link">页面渲染类</a></li><li class="sidebar-sub-header"><a href="/frontend/advanced/performance.html#移动端常见优化" class="sidebar-link">移动端常见优化</a></li><li class="sidebar-sub-header"><a href="/frontend/advanced/performance.html#webpack-构建优化" class="sidebar-link">webpack 构建优化</a></li><li class="sidebar-sub-header"><a href="/frontend/advanced/performance.html#构建速度优化" class="sidebar-link">构建速度优化</a></li><li class="sidebar-sub-header"><a href="/frontend/advanced/performance.html#构建体积优化" class="sidebar-link">构建体积优化</a></li></ul></li><li><a href="/frontend/advanced/performance.html#图片优化" class="sidebar-link">图片优化</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/frontend/advanced/performance.html#服务端渲染-ssr" class="sidebar-link">服务端渲染 SSR</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/frontend/advanced/performance.html#客户端渲染优缺点" class="sidebar-link">客户端渲染优缺点</a></li><li class="sidebar-sub-header"><a href="/frontend/advanced/performance.html#服务端渲染的优缺点" class="sidebar-link">服务端渲染的优缺点</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="性能优化类"><a href="#性能优化类" aria-hidden="true" class="header-anchor">#</a> 性能优化类</h1> <h2 id="性能测试"><a href="#性能测试" aria-hidden="true" class="header-anchor">#</a> 性能测试</h2> <h2 id="性能优化"><a href="#性能优化" aria-hidden="true" class="header-anchor">#</a> 性能优化</h2> <h3 id="网络资源加载优化"><a href="#网络资源加载优化" aria-hidden="true" class="header-anchor">#</a> 网络资源加载优化</h3> <ol><li>减少 http 请求次数。懒加载，合并雪碧图，css 文件，js，CDN Combo，小图标转 base64 内嵌等</li> <li>减小 HTTP 请求大小。开启 gzip，压缩 js，css 文件，启用 http2，Cookie 隔离</li> <li>外链 CSS，js 文件，有利于缓存改动较小 css，js 文件，减少网络请求</li> <li>避免空的 src，href 等，依然会进行网络请求，直到失败阻塞其他网络请求</li> <li>使用 Cache-Control，ETag，Last-Modified 进行缓存</li> <li>静态资源分域存在，增加并行下载数</li> <li>CDN 加速</li> <li>缓存 Ajax 请求</li> <li>异步加载 JavaScript 资源</li> <li>DNS 预解析，同 prefetch 属性</li> <li>单张图片不超过 30 KB</li></ol> <h3 id="页面渲染类"><a href="#页面渲染类" aria-hidden="true" class="header-anchor">#</a> 页面渲染类</h3> <ol><li>置顶 CSS 资源，置尾 js 资源，是为了让 js 不阻塞页面渲染</li> <li>减少 DOM 的深度</li> <li>避免使用 table 和 iframe 表情，table 是全部渲染完成，一次绘制，因此在长表格时很耗性能</li></ol> <h4 id="回流和重绘"><a href="#回流和重绘" aria-hidden="true" class="header-anchor">#</a> 回流和重绘</h4> <p>常见重绘场景</p> <ol><li>更改 DOM 的几何属性，如 width，height，padding，margin 等。为耗时操作</li> <li>获取即时属性。offsetTop，scrollTop，clientTop，getComputedStyle 等</li> <li>更改 DOM 结构，如移动节点位置等</li></ol> <p>避免回流，减少重绘，核心思想与优化 DOM 一致</p> <ol><li>缓存样式改动，把改动用一个 js 对象缓存起来，再一起应用</li> <li>用 class 合并多个样式的改动，替代一条条 style 改动</li> <li>离线 DOM，使用 display:none，把 DOM 离线，经过频繁的改动后，再用 display:block 重新渲染</li></ol> <h4 id="dom-为什么慢"><a href="#dom-为什么慢" aria-hidden="true" class="header-anchor">#</a> DOM 为什么慢</h4> <ol><li>修改 DOM 需要 js 引擎和渲染引擎进行通信，需要一定通信成本</li> <li>修改 DOM 时触发的回流重绘同样导致渲染速度变慢
<ol><li>回流即 DOM 几何属性的变化，如修改元素宽高，隐藏元素等，浏览器需要重新计算元素的几何属性。因为在渲染树的布局（回流）阶段，浏览器时需要精密计算出每一个节点的位置，大小属性。反而言之，需要重新计算位置和大小，那么就回到了回流阶段</li> <li>重绘。也就是对应浏览器渲染中的绘制图层阶段，把DOM 图层转换为像素点，如颜色，背景等</li></ol></li></ol> <h4 id="dom-优化"><a href="#dom-优化" aria-hidden="true" class="header-anchor">#</a> DOM 优化</h4> <ol><li>减少 DOM 操作次数，如要插入一百条记录，不能插一百次，而是先用 js 生成一百条相关文档，然后一次插入到 DOM 中</li> <li>缓存 DOM 操作，使用 DOM Fragment 缓存 js 对于 DOM 节点的操作，比如在先把一百记录插到 DOM Fragment 中，在将 DOM Fragement 插入 DOM 中。又如如果一个元素进行了增删增操作，实际上只需要一次增操作，我使用 DOM Fragement 进行增删增之后，再进行更新。</li> <li>异步更新策略。一个 Event-Loop 会经过。macro-task -&gt; micro-task -&gt; 渲染更新 -&gt; 检查&amp;&amp; 执行 WebWoker。因此在异步更新的策略中，把更新任务放在 micro-task 里面可以最靠近渲染步骤，从而尽快地更新。而放在宏任务中，需要等下一轮的渲染</li></ol> <h3 id="移动端常见优化"><a href="#移动端常见优化" aria-hidden="true" class="header-anchor">#</a> 移动端常见优化</h3> <ol><li>首屏数据提前请求</li> <li>首屏按需加载，非首屏滚动加载，懒加载。首屏数据大小总共不超过 1MB</li> <li>内联必备的 CSS 和 JavaScript</li></ol> <h3 id="webpack-构建优化"><a href="#webpack-构建优化" aria-hidden="true" class="header-anchor">#</a> webpack 构建优化</h3> <p>webpack 打包主要围绕着两个问题，一是构建速度的问题，而是打包体积的问题</p> <h3 id="构建速度优化"><a href="#构建速度优化" aria-hidden="true" class="header-anchor">#</a> 构建速度优化</h3> <ol><li><p>启用缓存。如 babel 可以将转译结果缓存到文件系统</p></li> <li><p>DllPlugin，借鉴了 windows 动态连接库的思想，把可以把第三方库打包到一个单独的文件中，只有依赖发生变化时才会重新打包，从而解决 CommonsChunkPlugin 每次构建都重新构建一次 vendor 的问题</p></li> <li><p>happy pack 多线程打包</p></li></ol> <h3 id="构建体积优化"><a href="#构建体积优化" aria-hidden="true" class="header-anchor">#</a> 构建体积优化</h3> <ol><li>拆分资源。如 CommonsChunkPlugin 可以把公用的依赖打包到一个chunk，从而防止重复打包依赖。拆分资源也有体积缩小和按需加载</li> <li>删除冗余代码。tree-shaking，可以在编译过程中删除在上下文中未引用到的代码，依赖于 ES6 的 import/export 静态结构特性。tree-shaking 仅进行标记，故也需要一个能够删除未引用代码的插件如 UglifyJSPlugin</li> <li>按需加载。如 webpack import()，和 require.ensure 会在这个语句执行时创建一个入口端点，这个模块以及其子模块就会被单独打包到一个文件中。</li></ol> <h2 id="图片优化"><a href="#图片优化" aria-hidden="true" class="header-anchor">#</a> 图片优化</h2> <ol><li>jpg 有损失压缩，压缩比大，色彩丰富，使用于大图</li> <li>png 无损压缩，色彩多，支持透明度，适用于边缘感强，带透明度的小图标</li> <li>svg 优点是文件体积小，矢量图形，放大不失真，可编程，缺点是占用渲染成本，一定学习成本</li> <li>Base64 和 CSS Sprites。Base64，是一种编码方式，通过把小图转 base64 格式，嵌入到 html 中，从而减少 http 请求次数，适用 2Kb 以下，不经常改变的小图标。CSS Sprites，把多个形状规则的小图标合成一张大图，通过 background-position 去定位图标，主要目的是为了减少 http 请求次数</li> <li>webp。集有多种图片格式的优点于一身，支持色彩丰富，压缩比高，支持透明度，支持动态图片。缺点是兼容性差，仅谷歌的支持性好。可以在前端采用降级方案，如果不支持 webp 就降级成 jpg。如淘宝采用 xxx.jpg.webp 这种格式，在检测到不支持 webp 时，就去掉 .webp 从而去请求 jpg 格式</li></ol> <h2 id="服务端渲染-ssr"><a href="#服务端渲染-ssr" aria-hidden="true" class="header-anchor">#</a> 服务端渲染 SSR</h2> <p>客户端渲染，即 dom 和 内容由客户端浏览器跑 js 生成。</p> <p>服务端渲染，即服务器把需要的组件或页面渲染成 html 字符，然后返回给客户端，客户端拿到的就是直接可渲染然后可以呈现给用户的 html 内容，不需要再去为了生成 dom 再去跑一遍 js</p> <h3 id="客户端渲染优缺点"><a href="#客户端渲染优缺点" aria-hidden="true" class="header-anchor">#</a> 客户端渲染优缺点</h3> <p>有利于减少服务器压力，充分利用浏览器资源。缺点是不利于 SEO 优化，不利于首屏的加载。</p> <h3 id="服务端渲染的优缺点"><a href="#服务端渲染的优缺点" aria-hidden="true" class="header-anchor">#</a> 服务端渲染的优缺点</h3> <p>有利于 SEO，首屏加载。缺点是大大增大了服务端的压力</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.ccbd119b.js" defer></script><script src="/assets/js/2.7f0dc0b6.js" defer></script><script src="/assets/js/10.0efb1b32.js" defer></script>
  </body>
</html>
